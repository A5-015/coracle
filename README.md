## Coracle

Welcome to Coracle, a consensus algorithm simulator for heterogeneous networks.

#### Installation

Compile from source as follows:

```
# get source & deps
git clone https://github.com/heidi-ann/coracle
opam install sexplib
cd coracle
# build
ocaml setup.ml -configure
ocaml setup.ml -build
ocaml setup.ml -install
```

#### Usage

We currently support two interfaces: command line implementation and simulation.

##### Implementation

Run an consensus algorithm as follows:
```
./cmdline.byte 1 --max=5
```
This instance will bind locally to port 5001 (5000+id) and will try to communicate with other instances at ports 5000 to 5004 (5000 to 5000+max-1).

##### Simulation

Ran a simulation as follows:
```
./simulator.byte -n 5
```
This will ran a simualator with 5 nodes.

##### Bugs

Please send any comments, questions or bugs to GitHub issue tracker:
https://github.com/heidi-ann/coracle/issues

##### License

This code is released under the MIT License, see the [LICENSE](/master/LICENSE) file for full details.

#### Contribute

This project is in the early development stages and we plan to have the first prototype release ready for [SIGCOMM '15](http://conferences.sigcomm.org/sigcomm/2015/) on 17th Aug 2015. Contributions are welcome, these are best make via pull requests and using Github issues to mark that your working on a particular issues or features. The current codebase is structured as follows:

* [lib/](../blob/master/lib) - Prue protocol implementation
* [lwt/](../blob/master/lwt) - Unix frontend for consensus protocols
* [sim/](../blob/master/sim) - Simulation frontend for coracle
* [_oasis](../blob/master/_oasis) - Configuration file for the [OASIS](http://oasis.forge.ocamlcore.org/) build system
* [_tags](../blob/master/_tags), [myocamlbuild.ml](../blob/master/myocamlbuild.ml), [setup.ml](../blob/master/setup.ml) - files auto generated by OASIS, included so that OASIS is not a project dependency


#### ToDos

##### Common backend
- [ ] Abstract over Consensus algorithms

##### Raft
- [ ] Support AppendEntries
- [ ] Support Client Interation
- [ ] Support for Read-only Comamnds 

##### VRR
- [ ] Implement VRR 

##### Simulation frontend (OCaml)
- [ ] Parsing simulation config in JSON
- [ ] Terminating simulation at specified time
- [ ] Ability to store and query hetrozengous networks, later labelled with parameters like node failure rates, link direction, link latency, probability of packet loss, bandwidth etc..
- [ ] Allow simulated/random/uniform client workloads

##### Simulation frontend (JS)
- [ ] Simple prototype JS frontend
  - [ ] user selectes between raft and vrr, number of nodes, number of secs to simulate and main timeout parameter
  - [ ] intermediate service runs OCaml simulator process with parameters expressed in JSON
  - [ ] OCaml simulator process terminates returning simulation stats in JSON
  - [ ] stats are displayed to the user
- [ ] Allow the user to select between a set of sample network topologies
- [ ] Allow the user to draw static network topologies and label it
- [ ] Allow the user to run multi simulations at once
- [ ] Return results as graphs instead of just a table of stats

##### Unix frontend
- [ ] Decople server id and port/host address
- [ ] Support for config files, with a subset of [logcabin's options](https://github.com/logcabin/logcabin/blob/master/sample.conf).
- [ ] Support for state machines as a seperate process (or even on an separate host), comms via sockets/pipes/ other IPCs
- [ ] Proper client side executable with suuport for an application as a separate process
- [ ] Really support for persistent storage, with write-ahead logging

##### Admin \& Housekeeping
- [ ] Adding Travis-CI support
- [ ] Choose and implement a logging solution throughout code base, syslog compatible
- [ ] add coracle to OPAM
- [ ] add copyright/license notice to each file header

##### Demo
- [ ] Register coracle domain
- [ ] Setup Coracle on Azure, may need multiple machines/processes with load balancing

#### Ideas for future features

- [ ] Support for other consensus protocols such as original Paxos, Zab or EPaxos
- [ ] Dynamic membership implementation for Raft and VRR plus abiliy to test in simulation
- [ ] MirageOS frontend 
- [ ] Complete JS implementation using js_of_ocaml
- [ ] Support for non-ocaml consensus protocols
- [ ] Support for simulating dynamic network topologies
- [ ] Split this code into 3 or 4 seperate repositories 

